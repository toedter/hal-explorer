@if (isCustomTheme) {
  <div>
    <link [href]="selectedThemeUrl" rel="stylesheet" />
  </div>
}

<nav class="navbar navbar-expand-lg navbar-toggleable-md navbar-dark bg-dark">
  <div class="container-fluid">
    <div class="navbar-brand">
      <img src="favicon.ico" width="30" height="30" class="d-inline-block align-top" alt="" />
      HAL Explorer
    </div>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbar1"
      aria-controls="navbar1"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar1">
      <ul class="navbar-nav">
        <!-- Color Mode Dropdown (Light/Dark/Auto) -->
        <!-- Icon-only button by design - accessible via aria-label. SonarQube S6841 false positive. -->
        <li class="nav-item dropdown">
          <button
            class="btn btn-link nav-link py-2 px-0 px-lg-2 dropdown-toggle d-flex align-items-center"
            id="bd-theme"
            type="button"
            aria-expanded="false"
            data-bs-toggle="dropdown"
            data-bs-display="static"
            aria-label="Toggle color mode"
          >
            @if (activeColorMode === 'light') {
              <i class="bi bi-sun-fill" aria-hidden="true"></i>
            }
            @if (activeColorMode === 'dark') {
              <i class="bi bi-moon-stars-fill" aria-hidden="true"></i>
            }
            @if (activeColorMode === 'auto') {
              <i class="bi bi-circle-half" aria-hidden="true"></i>
            }
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme">
            <li>
              <button
                type="button"
                class="dropdown-item d-flex align-items-center"
                (click)="setColorMode('light')"
                [class.active]="activeColorMode === 'light'"
                [attr.aria-pressed]="activeColorMode === 'light'"
              >
                <i class="bi bi-sun-fill me-2 opacity-50"></i>
                Light
                @if (activeColorMode === 'light') {
                  <i class="bi bi-check2 ms-auto"></i>
                }
              </button>
            </li>
            <li>
              <button
                type="button"
                class="dropdown-item d-flex align-items-center"
                (click)="setColorMode('dark')"
                [class.active]="activeColorMode === 'dark'"
                [attr.aria-pressed]="activeColorMode === 'dark'"
              >
                <i class="bi bi-moon-stars-fill me-2 opacity-50"></i>
                Dark
                @if (activeColorMode === 'dark') {
                  <i class="bi bi-check2 ms-auto"></i>
                }
              </button>
            </li>
            <li>
              <button
                type="button"
                class="dropdown-item d-flex align-items-center"
                (click)="setColorMode('auto')"
                [class.active]="activeColorMode === 'auto'"
                [attr.aria-pressed]="activeColorMode === 'auto'"
              >
                <i class="bi bi-circle-half me-2 opacity-50"></i>
                Auto
                @if (activeColorMode === 'auto') {
                  <i class="bi bi-check2 ms-auto"></i>
                }
              </button>
            </li>
          </ul>
        </li>
        <!-- Bootstrap Themes Dropdown (cosmo, darkly, etc.) -->
        <li class="nav-item dropdown">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            id="navbarDropdownTheme"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Theme
          </button>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownTheme">
            @for (theme of themes; track theme) {
              @if (theme === '---') {
                <div class="dropdown-divider"></div>
              } @else {
                <button type="button" class="dropdown-item" (click)="changeTheme(theme)">
                  <i class="bi bi-check" [style]="getThemeIconCheckStyle(theme)"></i>{{ theme }}
                </button>
              }
            }
          </div>
        </li>
        <li class="nav-item dropdown">
          <button
            class="btn btn-link nav-link dropdown-toggle"
            id="navbarDropdownLayout"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Settings
          </button>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownLayout">
            @for (setting of settings; track $index) {
              <div>
                @if (setting === '---') {
                  <hr class="dropdown-divider" />
                }
                @if (setting !== '---') {
                  <button type="button" class="dropdown-item" (click)="selectSetting(setting)">
                    <i class="bi bi-check" [style]="getSettingsIconCheckStyle(setting)"></i>{{ setting }}
                  </button>
                }
              </div>
            }
          </div>
        </li>
        <li class="nav-item">
          <button type="button" class="btn btn-link nav-link" data-bs-toggle="modal" data-bs-target="#aboutModal">
            About
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Modal About Dialog -->
<div class="modal fade" id="aboutModal" tabindex="-1" aria-labelledby="aboutModalLabel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="aboutModalLabel">About HAL Explorer</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="blurActiveElement()"
        ></button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <table class="table table-striped table-sm">
            <thead class="visually-hidden">
              <tr>
                <th scope="col">Property</th>
                <th scope="col">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Author:</td>
                <td>Kai TÃ¶dter</td>
              </tr>
              <tr>
                <td>Version:</td>
                <td>{{ version }}</td>
              </tr>
              <tr>
                <td>GitHub:</td>
                <td>
                  <a class="p-0 text-decoration-none" href="https://github.com/toedter/hal-explorer"
                    >https://github.com/toedter/hal-explorer</a
                  >
                </td>
              </tr>
              <tr>
                <td>Docs:</td>
                @if (isSnapshotVersion) {
                  <td>
                    <a
                      class="p-0 text-decoration-none"
                      href="https://toedter.github.io/hal-explorer/snapshot/reference-doc/"
                      >Snapshot Reference Documentation</a
                    >
                  </td>
                }
                @if (!isSnapshotVersion) {
                  <td>
                    <a
                      class="p-0 text-decoration-none"
                      href="https://toedter.github.io/hal-explorer/release/reference-doc/"
                      >Release Reference Documentation</a
                    >
                  </td>
                }
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="blurActiveElement()">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

@if (!isTwoColumnLayout) {
  <div class="container-fluid">
    <div class="resizable-layout">
      <div class="resizable-column" [style.width.%]="column1Width()">
        <app-uri-input></app-uri-input>
        <br />
        <app-response-explorer></app-response-explorer>
      </div>
      <div
        class="resize-handle"
        [class.active]="resizingHandle() === 1"
        (mousedown)="startResize($event, 1)"
        (touchstart)="startResize($event, 1)"
        role="separator"
        aria-orientation="vertical"
        aria-label="Resize columns"
      >
        <div class="resize-handle-line"></div>
      </div>
      <div class="resizable-column" [style.width.%]="column2Width()">
        <app-response-details></app-response-details>
      </div>
      <div
        class="resize-handle"
        [class.active]="resizingHandle() === 2"
        (mousedown)="startResize($event, 2)"
        (touchstart)="startResize($event, 2)"
        role="separator"
        aria-orientation="vertical"
        aria-label="Resize columns"
      >
        <div class="resize-handle-line"></div>
      </div>
      <div class="resizable-column" [style.width.%]="column3Width()">
        <app-documentation></app-documentation>
      </div>
    </div>
  </div>
}

@if (isTwoColumnLayout) {
  <div class="container-fluid">
    <div class="resizable-layout">
      <div class="resizable-column" [style.width.%]="column1Width()">
        <app-uri-input></app-uri-input>
        <br />
        <app-response-explorer></app-response-explorer>
      </div>
      <div
        class="resize-handle"
        [class.active]="resizingHandle() === 1"
        (mousedown)="startResize($event, 1)"
        (touchstart)="startResize($event, 1)"
        role="separator"
        aria-orientation="vertical"
        aria-label="Resize columns"
      >
        <div class="resize-handle-line"></div>
      </div>
      <div class="resizable-column" [style.width.%]="column2Width()">
        <app-response-details [hidden]="showDocumentation"></app-response-details>
        <app-documentation></app-documentation>
      </div>
    </div>
  </div>
}
